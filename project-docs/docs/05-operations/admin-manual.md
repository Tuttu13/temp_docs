---
sidebar_position: 2
---

# 運用マニュアル（管理者向け）

## 📌 概要
システム設定・操作方法を定義した管理者向けマニュアルです。

## 🔐 アクセス方法

### 管理画面へのログイン

1. ブラウザで管理画面URLにアクセス: `https://admin.example.com`
2. 管理者メールアドレスとパスワードを入力
3. 多要素認証コードを入力（設定している場合）
4. 「ログイン」をクリック

### SSH接続（必要な場合）

```bash
# 踏み台サーバー経由で接続
ssh -i ~/.ssh/prod-key.pem ec2-user@<bastion-ip>

# ECSタスクへの接続
aws ecs execute-command \
  --cluster app-cluster \
  --task <task-id> \
  --container app \
  --interactive \
  --command "/bin/bash"
```

## 👥 ユーザー管理

### ユーザーの作成

1. 管理画面 > ユーザー管理 > 新規作成
2. 必須項目を入力:
   - メールアドレス
   - ユーザー名
   - 役割（ユーザー/モデレーター/管理者）
3. 「作成」をクリック
4. 初期パスワードがメールで送信される

### ユーザーの編集

1. 管理画面 > ユーザー管理 > ユーザー一覧
2. 編集したいユーザーの「編集」ボタンをクリック
3. 必要な情報を変更
4. 「保存」をクリック

### ユーザーの削除

1. 管理画面 > ユーザー管理 > ユーザー一覧
2. 削除したいユーザーの「削除」ボタンをクリック
3. 確認ダイアログで「削除」を確認
4. ユーザーが論理削除される（データは保持）

### パスワードリセット

1. 管理画面 > ユーザー管理 > ユーザー一覧
2. 対象ユーザーの「パスワードリセット」をクリック
3. リセット用リンクがメールで送信される

## 📝 コンテンツ管理

### 投稿の管理

#### 投稿の承認

1. 管理画面 > コンテンツ管理 > 承認待ち投稿
2. 投稿を確認
3. 「承認」または「却下」をクリック

#### 投稿の編集

1. 管理画面 > コンテンツ管理 > 投稿一覧
2. 編集したい投稿の「編集」をクリック
3. 内容を編集
4. 「保存」をクリック

#### 投稿の削除

1. 管理画面 > コンテンツ管理 > 投稿一覧
2. 削除したい投稿の「削除」をクリック
3. 削除理由を入力
4. 「削除」を確認

### カテゴリ管理

1. 管理画面 > コンテンツ管理 > カテゴリ
2. 「新規カテゴリ」をクリック
3. カテゴリ名とスラッグを入力
4. 「作成」をクリック

## ⚙️ システム設定

### サイト基本設定

1. 管理画面 > 設定 > 一般設定
2. 以下の項目を設定:
   - サイト名
   - サイト説明
   - メタデータ
   - タイムゾーン
3. 「保存」をクリック

### メール設定

1. 管理画面 > 設定 > メール設定
2. SMTPサーバー情報を入力:
   - SMTPホスト
   - ポート
   - ユーザー名
   - パスワード
3. 「テスト送信」で動作確認
4. 「保存」をクリック

### API設定

1. 管理画面 > 設定 > API設定
2. APIキーの生成・管理
3. レート制限の設定
4. 「保存」をクリック

## 📊 レポート・分析

### アクセス統計

1. 管理画面 > レポート > アクセス統計
2. 期間を選択
3. 以下のデータを確認:
   - ページビュー
   - ユニークユーザー
   - 人気ページ
   - リファラー

### ユーザーアクティビティ

1. 管理画面 > レポート > ユーザーアクティビティ
2. アクティブユーザー数
3. 新規登録数
4. ログイン履歴

### エラーログ

1. 管理画面 > レポート > エラーログ
2. ログレベルでフィルター
3. エラー内容を確認

## 🔧 保守作業

### データベースバックアップ

#### 手動バックアップ

```bash
# AWS CLIでスナップショット作成
aws rds create-db-snapshot \
  --db-instance-identifier prod-db \
  --db-snapshot-identifier manual-backup-$(date +%Y%m%d)
```

#### バックアップの確認

```bash
# スナップショット一覧
aws rds describe-db-snapshots \
  --db-instance-identifier prod-db
```

### キャッシュのクリア

#### Redisキャッシュクリア

```bash
# 全キャッシュクリア
redis-cli FLUSHALL

# 特定のキーパターンを削除
redis-cli --scan --pattern "cache:*" | xargs redis-cli DEL
```

#### CDNキャッシュクリア

```bash
# CloudFront無効化
aws cloudfront create-invalidation \
  --distribution-id <distribution-id> \
  --paths "/*"
```

### ログローテーション

ログは自動的にローテーションされますが、手動で実行する場合:

```bash
# ログローテーション実行
logrotate -f /etc/logrotate.d/app

# 古いログの削除（30日以上前）
find /var/log/app -name "*.log" -mtime +30 -delete
```

## 🚨 トラブルシューティング

### よくある問題と対処法

#### ログインできない

**原因**: パスワード間違い、アカウントロック  
**対処法**:
1. パスワードリセットリンクを送信
2. アカウントロックの場合は管理者が解除
3. 多要素認証の問題の場合はバックアップコード使用

#### メールが送信されない

**原因**: SMTP設定の問題、メール送信制限  
**対処法**:
1. SMTP設定を確認
2. メール送信ログを確認
3. SESのバウンス・苦情率を確認

#### ページが表示されない

**原因**: サーバーエラー、メンテナンス中  
**対処法**:
1. サーバーステータスを確認
2. エラーログを確認
3. 必要に応じてサーバー再起動

### 緊急連絡先

| トラブル | 連絡先 | 対応時間 |
|---------|--------|---------|
| システム障害 | oncall@example.com | 24/7 |
| セキュリティ問題 | security@example.com | 24/7 |
| その他の問い合わせ | support@example.com | 平日9-18時 |

## 📝 備考

### 権限について

| 操作 | 管理者 | モデレーター | ユーザー |
|------|--------|------------|---------|
| ユーザー管理 | ○ | × | × |
| コンテンツ承認 | ○ | ○ | × |
| コンテンツ編集（全て） | ○ | ○ | × |
| コンテンツ編集（自分） | ○ | ○ | ○ |
| システム設定 | ○ | × | × |
| レポート閲覧 | ○ | ○ | × |

